!function(e,r){if("object"==typeof exports&&"object"==typeof module)module.exports=r();else if("function"==typeof define&&define.amd)define([],r);else{var t=r();for(var n in t)("object"==typeof exports?exports:e)[n]=t[n]}}(window,function(){return function(e){var r={};function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=13)}([function(e,r,t){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(r,"__esModule",{value:!0});var i=t(12);function o(e){return"[object Number]"==Object.prototype.toString.call(e)}function s(e){return"[object String]"==Object.prototype.toString.call(e)}function c(e){return"[object Array]"==Object.prototype.toString.call(e)}function a(e){return"[object Boolean]"==Object.prototype.toString.call(e)}function u(e){return"[object RegExp]"==Object.prototype.toString.call(e)}function l(e){return"[object Date]"==Object.prototype.toString.call(e)}function f(e){return void 0===e}function p(e){return null===e}function d(e){return"[object Symbol]"==Object.prototype.toString.call(e)}function v(e){return!("[object Object]"!=Object.prototype.toString.call(e)&&(o(e)||s(e)||a(e)||l(e)||u(e)||c(e)||p(e)||h(e)||f(e)||d(e)))}function g(e){if(!v(e))return!0;for(var r in e)return!1;return!0}function h(e){return"[object Function]"==Object.prototype.toString.call(e)}function b(e){return"object"===("undefined"==typeof HTMLElement?"undefined":n(HTMLElement))?e instanceof HTMLElement:e&&"object"===(void 0===e?"undefined":n(e))&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName}function y(e){var r=Object.prototype.toString.call(e);return"[object global]"==r||"[object Window]"==r||"[object DOMWindow]"==r}r.dateFormat=function(e,r){if(!r||"string"!=typeof r)return console.error("format is undefiend or type is Error"),"";var t={"y+":(e=e instanceof Date?e:"number"==typeof e||"string"==typeof e?new Date(e):new Date).getFullYear(),"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds()};for(var n in t)if(new RegExp(n).test(r)){var i=RegExp.lastMatch;r=r.replace(i,t[n]<10?"0"+t[n]:t[n].toString())}return r},r.isNumber=o,r.isString=s,r.isArray=c,r.isBoolean=a,r.isRegExp=u,r.isDateObject=l,r.isUndefined=f,r.isNull=p,r.isExist=function(e){return!f(e)&&!p(e)},r.isSymbol=d,r.isSVGElement=function(e){return b(e)&&(e instanceof SVGElement||e.ownerSVGElement)},r.isObject=v,r.isEmptyObject=g,r.isEmptyArray=function(e){return!(c(e)&&e.length>0)},r.isFunction=h,r.isElement=b,r.isWindow=y,r.isPlainObject=function(e){var r,t=Object.prototype.hasOwnProperty;if(!e||"object"!==(void 0===e?"undefined":n(e))||e.nodeType||y(e))return!1;try{if(e.constructor&&!t.call(e,"constructor")&&!t.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}for(r in e);return void 0===r||t.call(e,r)},r.toArray=function(e){return Array.prototype.slice.call(e)},r.toString=function(e){return e?"string"==typeof e?e:e.toString():""},r.setSessionStorage=function(e,r){window.sessionStorage&&(e="keepObserverData_"+e,r=JSON.stringify(r),sessionStorage.setItem(e,r))},r.getSessionStorage=function(e){if(window.sessionStorage){e="keepObserverData_"+e;var r=sessionStorage.getItem(e);return r?JSON.parse(r):""}},r.removeSessionStorage=function(e){window.sessionStorage&&(e="keepObserverData_"+e,sessionStorage.removeItem(e))},r.setStorage=function(e,r){window.localStorage&&(e="keepObserverData_"+e,r=JSON.stringify(r),localStorage.setItem(e,r))},r.getStorage=function(e){if(window.localStorage){e="keepObserverData_"+e;var r=localStorage.getItem(e);return r?JSON.parse(r):""}},r.removeStorage=function(e){window.localStorage&&(e="keepObserverData_"+e,localStorage.removeItem(e))},r.getUniqueID=function(){return"xxxxxxxx-xxx-t-xxx--xxxxxxxx".replace(/[xyt]/g,function(e){var r=16*Math.random()|0,t=(new Date).getTime();return("x"==e?r:"t"==e?t:3&r|8).toString(16)})},r.extend=function e(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];if(0===r.length)return console.error("extends params is undefined"),{};if(1===r.length)return r[0];var n=r[0],i=r.slice(1,r.length);return v(n)||c(n)||(n={}),i.map(function(r){if(n===r)return!1;if(v(r))for(var t in r)v(r[t])?(n[t]=n[t]&&v(n[t])?n[t]:{},n[t]=e(n[t],r[t])):c(r[t])?(n[t]=n[t]&&c(n[t])?n[t]:[],n[t]=e(n[t],r[t])):n[t]=r[t];else if(c(r))for(var i=0;i<r.length;i++)v(r[i])?(n[i]=n[i]&&v(n[i])?n[i]:{},n[i]=e(n[i],r[i])):c(r[i])?(n[i]=n[i]&&c(n[i])?n[i]:[],n[i]=e(n[i],r[i])):n[i]=r[i]}),n},r.mixin=function(e,r){for(var t in r&&v(r)&&!g(r)||i.warnError("keepObserver $mixin receive params not right"),r)e[t]?i.warnError("keepObserver $mixin method key: "+t+" is exist"):Object.defineProperty(e,t,{configurable:!1,enumerable:!0,value:r[t]})}},function(e,r,t){"use strict";var n=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r};Object.defineProperty(r,"__esModule",{value:!0});var i=n(t(0));r.preventStackError=function(e){var r=e.msg,t=e.pipeIndex;if(!r||!i.isExist(t)||!i.isExist(r.data))return!0;if(!this.pipeUser[t])return this._config.develop&&this.$devError("[keepObserver] send pipe Message Maybe happend Endless loop , will ignore in the message"),!0;try{var n=JSON.stringify(r.data)}catch(e){return this.$devError("[keepObserver] find error : "+e),!0}return this.stackCountBuff[n]?this.stackCountBuff[n]++:this.stackCountBuff[n]=1,this.resetStackCount(),this.judgeAnomaly(this.stackCountBuff[n],e)},r.judgeAnomaly=function(e,r){r.msg;var t=r.pipeIndex;return e>10&&e<20?(this.$devWarn("[keepObserver] send  pipe Message during 1000ms in Over 20 times. maybe Anomaly "),!1):e>20&&(this.pipeUser[t]=null,this.$devError("[keepObserver] send pipe Message during 1000ms in Over 20 times,maybe happend Endless loop"),!0)},r.resetStackCount=function(){var e=this;e.stackTimeFlag||(e.stackTimeFlag=!0,setTimeout(function(){e.stackCountBuff={},e.stackTimeFlag=!1},1e3))}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=!1;r.isLock=function(){return this.receiveLock},r.openLock=function(){var e=this;if(e.receiveLock&&e._config.queueLock)return!1;e.receiveLock=!0,e._config.timeOutUnlock&&setTimeout(function(){e.closeLock()},e._config.receiveUnlockTime)},r.closeLock=function(){if(!this.receiveLock)return!1;n&&(window.cleanTimeout(n),n=!1),this.receiveLock=!1}},function(e,r,t){"use strict";var n=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r};Object.defineProperty(r,"__esModule",{value:!0});var i=n(t(0));r.sendPipeMessage=function(e,t,n){var o=this,s={pipeIndex:e,msg:t,options:n};return!o.isLock()&&!o.preventStackError(s)&&(o.messageQueue.push(s),!o.waiting&&void setTimeout(function(){var e=i.extend([],o.messageQueue);o.messageQueue=[],r.noticeListener.call(o,e)}))},r.noticeListener=function(e){var r=this;if(!i.isArray(e)||0===e.length)return!1;r.waiting=!0;for(var t=0;t<e.length;t++){var n=e[t],o=n.pipeIndex,s=n.msg,c=n.options;r.pipeUser.map(function(e,t){if(!e||!e.receiveCallback||!i.isFunction(e.receiveCallback))return!1;if(o===t)return!1;var n=e.receiveCallback;try{r.openLock();var a=n(s,c);a&&i.isObject(a)&&(a instanceof Promise||a.then&&i.isFunction(a.then))?a.then(r.closeLock,r.closeLock):r.closeLock()}catch(e){r.closeLock(),r.$devError("[keepObserver] use pipe message notice is runing error:"+e)}})}r.waiting=!1}},function(e,r,t){"use strict";var n=function(e,r){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var n,i,o=t.call(e),s=[];try{for(;(void 0===r||r-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(t=o.return)&&t.call(o)}finally{if(i)throw i.error}}return s},i=function(){for(var e=[],r=0;r<arguments.length;r++)e=e.concat(n(arguments[r]));return e},o=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r};Object.defineProperty(r,"__esModule",{value:!0});var s=o(t(0));r.registerRecivePipeMessage=function(e){var r=this;return r.pipeUser[e].receiveCallback?(r.$devError("[keepObsever] register recive pipe index is Occupy"),!1):function(t,n){if(!t||!s.isFunction(t))return r.$devError("[keepObsever] registerRecivePipeMessage method receive function is not right"),!1;r.pipeUser[e].receiveCallback=function(){var e=s.toArray(arguments);return n?t.apply(n,e):t.apply(void 0,i(e))}}}},function(e,r,t){"use strict";var n=function(e,r){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var n,i,o=t.call(e),s=[];try{for(;(void 0===r||r-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(t=o.return)&&t.call(o)}finally{if(i)throw i.error}}return s},i=function(){for(var e=[],r=0;r<arguments.length;r++)e=e.concat(n(arguments[r]));return e},o=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r};Object.defineProperty(r,"__esModule",{value:!0});var s=o(t(0));r.use=function(e){if(!e||!s.isFunction(e))return this.$devError("[keepObserver] use method receive provider is not right"),!1;var r=new e(this._config),t=r.apply;if(!t||!s.isFunction(t))return this.$devError("[keepObserver] use method receive provider is not apply method"),!1;this.injection(r,t)},r.injection=function(e,r){var t=this;if(!r||!s.isFunction(r))return t.$devError("[keepObserver] injection receive ApplyFn is undefined or no function"),!1;var n=t.registerPipeListenerUser(),o={$devLog:function(){return t.$devLog.apply(t,i(arguments))},$devWarn:function(){return t.$devWarn.apply(t,i(arguments))},$devError:function(){return t.$devError.apply(t,i(arguments))}};try{var c=r.call(e,n,o);t.mixinKoInstance(e,c)}catch(e){t.$devError("[keepObserver] injection receive ApplyFn is runing find error:"+e)}},r.registerPipeListenerUser=function(){var e=this,r=e.pipeUser.length,t={pipeIndex:r,receiveCallback:null,sendPipeMessage:function(){return e.sendPipeMessage.apply(e,i([r],arguments))},registerRecivePipeMessage:null};return e.pipeUser[r]=t,t.registerRecivePipeMessage=e.registerRecivePipeMessage(r),{registerRecivePipeMessage:function(){return!!e.pipeUser[r]&&t.registerRecivePipeMessage.apply(t,i(arguments))},sendPipeMessage:function(){return!!e.pipeUser[r]&&t.sendPipeMessage.apply(t,i(arguments))}}},r.mixinKoInstance=function(e,r){var t=this;if(!r||s.isEmptyObject(r))return t.$devWarn("[keepObserver] injection ApplyFn return Object is undefined"),!1;var n=t.$keepObserver;for(var i in r){var o=r[i];o&&s.isFunction(o)||t.$devError("[keepObserver] injection ApplyFn return Object attr"+i+"is not right"),n[i]?t.$devError("[keepObserver] injection Discover namesake methods"):Object.defineProperty(n,i,{configurable:!1,enumerable:!0,value:function(r){return function(){var n=s.toArray(arguments);try{r.apply(e,n)}catch(e){t.$devError("[keepObserver] injection  methods "+i+" runing find error"+e)}}}(o)})}}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(5),i=t(4),o=t(3),s=t(2),c=t(1),a=function(){function e(e,r){this.injection=n.injection.bind(this),this.registerPipeListenerUser=n.registerPipeListenerUser.bind(this),this.registerRecivePipeMessage=i.registerRecivePipeMessage.bind(this),this.mixinKoInstance=n.mixinKoInstance.bind(this),this.sendPipeMessage=o.sendPipeMessage.bind(this),this.noticeListener=o.noticeListener.bind(this),this.isLock=s.isLock.bind(this),this.openLock=s.openLock.bind(this),this.closeLock=s.closeLock.bind(this),this.preventStackError=c.preventStackError.bind(this),this.judgeAnomaly=c.judgeAnomaly.bind(this),this.resetStackCount=c.resetStackCount.bind(this),this.use=n.use.bind(this),this._config=r,this.$keepObserver=e,this.waiting=!1,this.receiveLock=!1,this.stackCountBuff={},this.stackTimeFlag=!1,this.messageQueue=[],this.pipeUser=[]}return e.prototype.apply=function(){return{use:this.use}},e}();r.default=a},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.init=function(){this._config.projectVersion&&this._config.updateVersionClearCache&&this.updateVersionClearCache()}},function(e,r,t){"use strict";var n=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r};Object.defineProperty(r,"__esModule",{value:!0});var i=n(t(0)),o=/^keepObserverData/i;r.updateVersionClearCache=function(){var e=i.getStorage("versionRecord");if(!this._config.projectVersion||this._config.projectVersion===e)return!1;if(!window.localStorage)return!1;for(var r in window.localStorage)o.test(r)&&(localStorage.removeItem(r),this.$devWarn("[keepObserver] updateVersionRecord key:"+r));i.setStorage("versionRecord",this._config.projectVersion)}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.reportType=["unKownType","log","network","vue"],r.version="2.0.0-beta.1"},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default={queueLock:!0,timeOutUnlock:!0,forceUnlockTime:1e3,updateVersionClearCache:!1}},function(e,r,t){"use strict";var n=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r};Object.defineProperty(r,"__esModule",{value:!0});var i=n(t(0)),o=function(){if(!window.localStorage)return!1;var e=i.getStorage("deviceId");return e||(e=i.getUniqueID(),i.setStorage("deviceId",e)),e};r.default=function(){return o()}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=window.console.log,i=window.console.warn,o=window.console.error;window.console.log=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];n.apply(window.console,e)},window.console.error=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];o.apply(window.console,e)},window.console.warn=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];i.apply(window.console,e)},r.log=n,r.error=o,r.wran=i,r.warnError=function(e){return r.error("[keepObserver] find error! message: "+e)}},function(e,r,t){"use strict";var n=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r},i=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var o=n(t(0)),s=i(t(11)),c=i(t(10)),a=t(9),u=t(8),l=t(7),f=i(t(6)),p=function(){return function(e){this.init=l.init.bind(this),this.updateVersionClearCache=u.updateVersionClearCache.bind(this),this._config=o.extend(c.default,e,{version:a.version,deviceID:s.default()});var r=new f.default(this,this._config).apply();o.mixin(this,r),this.init()}}();e.exports=p,e.exports.default=e.exports}])});