{"version":3,"file":"KeepObserverVue.js","sources":["webpack:///webpack/universalModuleDefinition?5ca6**","webpack:///webpack/bootstrap c68d161effd90163ce5f?e1f8**","webpack:///src/tool/index.js?2d97**","webpack:///src/default/index.js?245b**","webpack:///src/services/observer/vue/api.js","webpack:///src/services/observer/vue/defaultConfig.js","webpack:///src/services/observer/vue/handle.js","webpack:///src/services/observer/vue/report.js","webpack:///src/services/observer/vue/index.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 33);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap c68d161effd90163ce5f","/**\n * 根据时间搓 返回时间\n * @param date format\n * @return string\n */\nexport function dateFormat(date, format) {\n    if (!format || typeof format !== 'string') {\n        console.error('format is undefiend or type is Error');\n        return '';\n    }\n    date = date instanceof Date ? date : (typeof date === 'number' || typeof date === 'string') ? new Date(date) : new Date();\n    //解析\n    var formatReg = {\n        'y+': date.getFullYear(),\n        'M+': date.getMonth() + 1,\n        'd+': date.getDate(),\n        'h+': date.getHours(),\n        'm+': date.getMinutes(),\n        's+': date.getSeconds(),\n    }\n    for (var reg in formatReg) {\n        if (new RegExp(reg).test(format)) {\n            var match = RegExp.lastMatch;\n            format = format.replace(match, formatReg[reg] < 10 ? '0' + formatReg[reg] : formatReg[reg].toString());\n        }\n    }\n    return format;\n}\n\n\n/**\n * 检查script基本数据类型\n * @param mixed value\n * @return boolean\n */\nexport function isNumber(value) {\n    return Object.prototype.toString.call(value) == '[object Number]';\n}\nexport function isString(value) {\n    return Object.prototype.toString.call(value) == '[object String]';\n}\nexport function isArray(value) {\n    return Object.prototype.toString.call(value) == '[object Array]';\n}\nexport function isBoolean(value) {\n    return Object.prototype.toString.call(value) == '[object Boolean]';\n}\nexport function isUndefined(value) {\n    return value === undefined;\n}\nexport function isNull(value) {\n    return value === null;\n}\nexport function isSymbol(value) {\n    return Object.prototype.toString.call(value) == '[object Symbol]';\n}\nexport function isObject(value) {\n    return (\n        Object.prototype.toString.call(value) == '[object Object]' ||\n        // if it isn't a primitive value, then it is a common object\n        (!isNumber(value) &&\n            !isString(value) &&\n            !isBoolean(value) &&\n            !isArray(value) &&\n            !isNull(value) &&\n            !isFunction(value) &&\n            !isUndefined(value) &&\n            !isSymbol(value)\n        )\n    );\n}\nexport function isEmptyObject(obj) {\n    if (!isObject(obj)) {\n        return true;\n    }\n    for (var key in obj) {\n        return false;\n    }\n    return true\n}\nexport function isEmptyArray(array) {\n    if (!isArray(array)) {\n        return true\n    }\n    return array.length > 0 ? false : true\n}\nexport function isFunction(value) {\n    return Object.prototype.toString.call(value) == '[object Function]';\n}\nexport function isElement(value) {\n    return (\n        typeof HTMLElement === 'object' ? value instanceof HTMLElement : //DOM2\n        value && typeof value === \"object\" && value !== null && value.nodeType === 1 && typeof value.nodeName === \"string\"\n    );\n}\nexport function isWindow(value) {\n    var toString = Object.prototype.toString.call(value);\n    return toString == '[object global]' || toString == '[object Window]' || toString == '[object DOMWindow]';\n}\n/**\n * 检查是否是普通空对象\n * @param object obj\n * @return boolean\n */\nexport function isPlainObject(obj) {\n    var hasOwn = Object.prototype.hasOwnProperty;\n    // Must be an Object.\n    if (!obj || typeof obj !== 'object' || obj.nodeType || isWindow(obj)) {\n        return false;\n    }\n    try {\n        if (obj.constructor && !hasOwn.call(obj, 'constructor') && !hasOwn.call(obj.constructor.prototype, 'isPrototypeOf')) {\n            return false;\n        }\n    } catch (e) {\n        return false;\n    }\n    var key;\n    for (key in obj) {}\n    return key === undefined || hasOwn.call(obj, key);\n}\n\n\n/*\n  转换工具\n */\nexport function toArray(array) {\n    return Array.prototype.slice.call(array)\n}\nexport function toString(content) {\n    if (!content) {\n        return '';\n    }\n    if (typeof content === 'string') {\n        return content\n    }\n    return content.toString()\n}\n\n\n\n/*\n    辅助存储保存监控数据\n    localStorage\n*/\nexport function setStorage(key, value) {\n    if (!window.localStorage) {\n        return;\n    }\n    key = 'keepObserverData_' + key;\n    value = JSON.stringify(value)\n    localStorage.setItem(key, value);\n}\nexport function getStorage(key) {\n    if (!window.localStorage) {\n        return;\n    }\n    key = 'keepObserverData_' + key;\n    var value = localStorage.getItem(key)\n    return value ? JSON.parse(value) : '';\n}\nexport function removeStorage(key) {\n    if (!window.localStorage) {\n        return;\n    }\n    key = 'keepObserverData_' + key;\n    localStorage.removeItem(key);\n}\n\n\n\n\n\n/*\n    深度合并内容\n    引用类型克隆合并\n    arguments[0] = target\n    arguments type is Object Or Array\n    多内容合并覆盖优先级: arguments[0]<arguments[1]<arguments[2]..\n    如果sources 不是数组或者对象 则直接忽略\n */\nexport function extend() {\n    var args = toArray(arguments);\n    if (args.length === 0) {\n        console.error('extends params is undefined')\n        return {};\n    }\n    if (args.length === 1) {\n        return args[0]\n    }\n    var target = args[0];\n    var sources = args.slice(1, args.length)\n\n    if (!isObject(target) && !isArray(target)) {\n        target = {};\n    }\n    sources.map(function(item) {\n        //防止死循环\n        if (target === item) {\n            return false;\n        }\n        //如果内容是对象 \n        if (isObject(item)) {\n            //开始遍历\n            for (var key in item) {\n                //如果内容是对象\n                if (isObject(item[key])) {\n                    //修正数据\n                    target[key] = (target[key] && isObject(target[key])) ? target[key] : {};\n                    target[key] = extend(target[key], item[key])\n                } else if (isArray(item[key])) {\n                    //修正数据\n                    target[key] = (target[key] && isArray(target[key])) ? target[key] : [];\n                    target[key] = extend(target[key], item[key])\n                } else {\n                    //基本类型直接赋值\n                    target[key] = item[key]\n                }\n            }\n        } else if (isArray(item)) {\n            for (var i = 0; i < item.length; i++) {\n                //如果内容是对象\n                if (isObject(item[i])) {\n                    //修正数据\n                    target[i] = (target[i] && isObject(target[i])) ? target[i] : {}\n                    target[i] = extend(target[i], item[i])\n                } else if (isArray(item[i])) {\n                    //修正数据\n                    target[i] = (target[i] && isArray(target[i])) ? target[i] : [];\n                    target[i] = extend(target[i], item[i])\n                } else {\n                    //基本类型直接赋值\n                    target[i] = item[i]\n                }\n            }\n        }\n        //其他类型直接忽略  \n    })\n    return target\n}\n\n\n// WEBPACK FOOTER //\n// src/tool/index.js","import * as tool from '../tool/index.js'\n\n//公共默认类\n//提供一些全局公共方法\nclass KeepObserverDefault {\n\n    constructor(config) {\n        //开发模式下的log 替换window.console.log\n        this.$devLog = false;\n        //开发模式写error log 替换window.console.error\n        this.$devError = false;\n\n        this._keeepObserverDetaultInit();\n    }\n\n\n    _keeepObserverDetaultInit() {\n        var that = this;\n        //初始化$devLog\n        that.$devLog = window.console.log\n        window.console.log = (...args) => {\n            that.$devLog.apply(window.console, args);\n        };\n        //初始化$devError\n        that.$devError = window.console.error\n        window.console.error = (...args) => {\n            that.$devError.apply(window.console, args);\n        };\n        //初始化$devWarn\n        that.$devWarn = window.console.warn\n        window.console.warn = (...args) => {\n            that.$devWarn.apply(window.console, args);\n        };\n    }\n\n\n\n    $mixin(provider) {\n        if (!provider || !tool.isObject(provider) || tool.isEmptyObject(provider)) {\n            this.$error('keepObserver $mixin receive params not right')\n        }\n        for (var key in provider) {\n            if (this[key]) {\n                continue\n            }\n            this[key] = provider[key]\n        }\n    }\n\n}\n\n\n\n\n\n\nexport default KeepObserverDefault;\n\n\n// WEBPACK FOOTER //\n// src/default/index.js","/*\n    \t停止监听\n*/\nexport var stopObserver = function() {\n    if (this._vue.config) {\n        this._vue.config.errorHandler = null;\n    }\n}\n\n\n\n\n/*\n\t开始监听\n */\nexport var startObserver = function() {\n    //开启vue错误监听\n    this._handleInit();\n}\n\n\n// WEBPACK FOOTER //\n// src/services/observer/vue/api.js","\n\n\n\n/*\n \n \tobserver vue 实例默认配置数据\n */ \nexport default {\n\t//是否启动性能分析   暂时未做\n\tisPerformance:true,\n}\n\n\n\n\n// WEBPACK FOOTER //\n// src/services/observer/vue/defaultConfig.js","import * as tool from '../../../tool/index.js';\n\n\n/*\n    \t开始监控vue\n */\nexport var _handleInit = function() {\n    var that = this;\n    if (that._vue.config) {\n        that._vue.config.errorHandler = (...args) => {\n            that._handleVueError(...args)\n        }\n    }\n}\n\n\n/*\n\t处理监控vue错误信息\n */\nexport var _handleVueError = function(err, vm, info) {\n    var that = this;\n    var errInfo = {}\n    errInfo.infoMsg = tool.toString(info);\n    //是否存在堆栈信息\n    if (tool.isObject(err) && err.stack && err.message) {\n        errInfo.errMsg = tool.toString(err.message)\n        errInfo.stackMsg = tool.toString(err.stack)\n    } else {\n        errInfo.errMsg = tool.toString(err);\n    }\n    errInfo.isError = true\n    //上报\n    that.noticeReport(errInfo)\n}\n\n\n// WEBPACK FOOTER //\n// src/services/observer/vue/handle.js","import * as tool from '../../../tool/index.js';\n\n\n\n//注册上报监听\nexport var addReportListener = function(callback) {\n    if (callback) {\n        this.eventListener.push(callback)\n    }\n}\n\n\n\n\n//处理整理数据\nexport var handleReportData = function(content) {\n    var reportParams = {};\n    var control = {};\n    reportParams.type = \"observer\"\n    reportParams.typeName = 'vue';\n    reportParams.location = window.location.href;\n    reportParams.environment = window.navigator.userAgent;\n    reportParams.data = content;\n    reportParams.reportTime = new Date().getTime();\n    //option\n    control.lazy = true;\n    if (content.isError) {\n        control.lazy = false;\n        control.baseExtend = true;\n        control.isError = true;\n        control.isReport = true;\n    }\n    return {\n        reportParams: reportParams,\n        control: control\n    }\n}\n\n\n\n\n//通知上报\nexport var noticeReport = function(content) {\n    var that = this;\n    if (that.eventListener.length === 0) {\n        return false;\n    }\n    //通知上报\n    that.eventListener.map(function(item) {\n        if (tool.isFunction(item)) {\n            var {\n                reportParams,\n                control\n            } = that.handleReportData(content)\n            item(reportParams, control);\n        }\n    })\n}\n\n\n// WEBPACK FOOTER //\n// src/services/observer/vue/report.js","import defaultConfig from './defaultConfig.js';\nimport * as tool from '../../../tool/index.js';\n\n\nimport * as handleServer from './handle.js'\nimport * as apiServer from './api.js'\nimport * as reportServer from './report.js'\n\nimport KeepObserverDetault from '../../../default/index.js';\n\n\n\n// 获取系统信息\nclass KeepObserverVue extends KeepObserverDetault {\n    //构造函数\n    constructor(config) {\n        super()\n        //初始化上传相关实例\n        var vueConfig = config.vueCustom || {};\n        vueConfig.vueInstance = config.vueInstance;\n        //判断是否存在实例\n        if (!vueConfig.vueInstance) {\n            return false;\n        }\n        //存混合配置\n        this._config = tool.extend(defaultConfig, vueConfig)\n        //上报名\n        this._typeName = 'vue'\n        //vue实例\n        this._vue = this._config.vueInstance;\n        //监听列表\n        this.eventListener = [];\n        //混入自身方法\n        this.$mixin(handleServer)\n        this.$mixin(apiServer)\n        this.$mixin(reportServer)\n        // 开启vue拦截\n        this.startObserver();\n    }\n\n    //提供一个挂载入口\n    apply(pipe) {\n        this.addReportListener(pipe.sendPipeMessage)\n        return {\n            $vueStop: this.stopObserver,\n            $vueStart: this.startObserver\n        }\n    }\n}\n\n\n\n\nexport default KeepObserverVue\n\n\n// WEBPACK FOOTER //\n// src/services/observer/vue/index.js"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;AC3DA;AA8BA;AAGA;AAGA;AAGA;AAGA;AAGA;AAGA;AAGA;AAeA;AASA;AAMA;AAGA;AAMA;AASA;AAsBA;AAGA;AAgBA;AAQA;AAQA;AAoBA;AArLA;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAKA;;;;;;;;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;AC/OA;AACA;AADA;AACA;;;;;AACA;AACA;AACA;AAEA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AACA;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;AASA;;;;;;;;;;;;;ACxDA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AAIA;;;AAGA;AACA;AACA;AACA;;;;;;;;;;;;;;;ACdA;AACA;;;AAGA;AACA;AACA;AAFA;;;;;;;;;;;;;;;ACRA;AACA;AADA;AACA;;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;ACjCA;AACA;AADA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAIA;AACA;AACA;AACA;;;;;;;;;;;;;;;;ACzDA;AACA;;;AAAA;AACA;AADA;AACA;AAEA;AACA;AADA;AACA;AAAA;AACA;AADA;AACA;AAAA;AACA;AADA;AACA;AACA;AACA;;;;;;;;;;;;;AAGA;AACA;;;AACA;AACA;AAAA;AACA;AACA;AAFA;AACA;AAEA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAtBA;AAuBA;AACA;AACA;AACA;AACA;;;AADA;AACA;AACA;AACA;AACA;AAFA;AAIA;;;;AAlCA;AACA;AAuCA;;;;;A","sourceRoot":""}