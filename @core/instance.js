!function(e,r){if("object"==typeof exports&&"object"==typeof module)module.exports=r();else if("function"==typeof define&&define.amd)define([],r);else{var t=r();for(var n in t)("object"==typeof exports?exports:e)[n]=t[n]}}(window,function(){return function(e){var r={};function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=52)}([function(e,r,t){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0});var i=t(1);function o(e){return"[object Number]"==Object.prototype.toString.call(e)}function s(e){return"[object String]"==Object.prototype.toString.call(e)}function a(e){return"[object Array]"==Object.prototype.toString.call(e)}function u(e){return"[object Boolean]"==Object.prototype.toString.call(e)}function c(e){return"[object RegExp]"==Object.prototype.toString.call(e)}function f(e){return"[object Date]"==Object.prototype.toString.call(e)}function l(e){return void 0===e}function p(e){return null===e}function d(e){return"[object Symbol]"==Object.prototype.toString.call(e)}function v(e){return!("[object Object]"!=Object.prototype.toString.call(e)&&(o(e)||s(e)||u(e)||f(e)||c(e)||a(e)||p(e)||h(e)||l(e)||d(e)))}function g(e){if(!v(e))return!0;for(var r in e)return!1;return!0}function y(e){return!a(e)||!(e.length>0)}function h(e){return"[object Function]"==Object.prototype.toString.call(e)}function _(e){return"object"===("undefined"==typeof HTMLElement?"undefined":n(HTMLElement))?e instanceof HTMLElement:e&&"object"===n(e)&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName}function b(e){var r=Object.prototype.toString.call(e);return"[object global]"==r||"[object Window]"==r||"[object DOMWindow]"==r}function m(e){var r,t=Object.prototype.hasOwnProperty;if(!e||"object"!==n(e)||e.nodeType||b(e))return!1;try{if(e.constructor&&!t.call(e,"constructor")&&!t.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}for(r in e);return void 0===r||t.call(e,r)}function O(e){return Array.prototype.slice.call(e)}r.dateFormat=function(e,r){if(!r||"string"!=typeof r)return console.error("format is undefiend or type is Error"),"";var t={"y+":(e=e instanceof Date?e:"number"==typeof e||"string"==typeof e?new Date(e):new Date).getFullYear(),"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds()};for(var n in t)if(new RegExp(n).test(r)){var i=RegExp.lastMatch;r=r.replace(i,t[n]<10?"0"+t[n]:t[n].toString())}return r},r.isNumber=o,r.isString=s,r.isArray=a,r.isBoolean=u,r.isRegExp=c,r.isDateObject=f,r.isUndefined=l,r.isNull=p,r.isExist=function(e){return!l(e)&&!p(e)},r.isSymbol=d,r.isSVGElement=function(e){return _(e)&&(e instanceof SVGElement||e.ownerSVGElement)},r.isObject=v,r.isEmptyObject=g,r.isEmptyArray=y,r.isFunction=h,r.isElement=_,r.isWindow=b,r.isPlainObject=m,r.isClassObject=function(e){return!(!v(e)||m(e))},r.toArray=O,r.toString=function(e){return e?"string"==typeof e?e:e.toString():""},r.setSessionStorage=function(e,r){window.sessionStorage&&(e="keepObserverData_"+e,r=JSON.stringify(r),sessionStorage.setItem(e,r))},r.getSessionStorage=function(e){if(window.sessionStorage){e="keepObserverData_"+e;var r=sessionStorage.getItem(e);return r?JSON.parse(r):""}},r.removeSessionStorage=function(e){window.sessionStorage&&(e="keepObserverData_"+e,sessionStorage.removeItem(e))},r.setStorage=function(e,r){window.localStorage&&(e="keepObserverData_"+e,r=JSON.stringify(r),localStorage.setItem(e,r))},r.getStorage=function(e){if(window.localStorage){e="keepObserverData_"+e;var r=localStorage.getItem(e);return r?JSON.parse(r):""}},r.removeStorage=function(e){window.localStorage&&(e="keepObserverData_"+e,localStorage.removeItem(e))},r.getUniqueID=function(){return"xxxxxxxx-xxx-t-xxx--xxxxxxxx".replace(/[xyt]/g,function(e){var r=16*Math.random()|0,t=(new Date).getTime();return("x"==e?r:"t"==e?t:3&r|8).toString(16)})},r.extend=function e(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var n=O(arguments);if(0===n.length)return console.error("extends params is undefined"),{};if(1===n.length)return n[0];var i=n[0],o=n.slice(1,n.length);return v(i)||a(i)||(i={}),o.map(function(r){if(i===r)return!1;if(v(r))for(var t in r)v(r[t])&&!g(r[t])?(i[t]=i[t]&&v(i[t])?i[t]:{},i[t]=e(i[t],r[t])):a(r[t])&&!y(r[t])?(i[t]=i[t]&&a(i[t])?i[t]:[],i[t]=e(i[t],r[t])):v(r[t])&&g(r[t])?i[t]={}:a(r[t])&&y(r[t])?i[t]=[]:i[t]=r[t];else if(a(r))for(var n=0;n<r.length;n++)v(r[n])&&!g(r[n])?(i[n]=i[n]&&v(i[n])?i[n]:{},i[n]=e(i[n],r[n])):a(r[n])&&!y(r[n])?(i[n]=i[n]&&a(i[n])?i[n]:[],i[n]=e(i[n],r[n])):v(r[n])&&g(r[n])?i[n]={}:a(r[n])&&y(r[n])?i[n]=[]:i[n]=r[n]}),i},r.mixin=function(e,r){for(var t in r&&v(r)&&!g(r)||i.warnError("keepObserver $mixin receive params not right"),r)e[t]?i.warnError("keepObserver $mixin method key: "+t+" is exist"):Object.defineProperty(e,t,{configurable:!1,enumerable:!0,value:r[t]})},r.filter=function(e,r){if(!a(e)&&!v(e)||!h(r))return e;if(a(e))return e.filter(r);var t={};for(var n in e){var i=e[n];r(i,n)&&(t[n]=i)}return t},r.map=function(e,r){if(!a(e)&&!v(e)||!h(r))return e;if(a(e))return e.map(r);var t={};for(var n in e){var i=e[n];t[n]=r(i,n)}return t}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=window.console.log,i=window.console.warn,o=window.console.error;window.console.log=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];n.apply(window.console,e)},window.console.error=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];o.apply(window.console,e)},window.console.warn=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];i.apply(window.console,e)},r.log=n,r.error=o,r.wran=i,r.warnError=function(e,t){if(void 0===t&&(t=!0),t)return r.error("[keepObserver] find error! message: "+e)}},function(e,r,t){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var o=n(t(0)),s=t(1),a=i(t(3)),u=function(){function e(e){var r=e.develop,t=void 0!==r&&r;this._develop=t,this.middleWareInstance=new a.default(e)}return e.prototype.useMiddle=function(){},e.prototype.runMiddle=function(){},e.prototype.addReportListener=function(e){e&&this.eventListener.push(e)},e.prototype.noticeReport=function(e,r){var t=this;return 0!==t.eventListener.length&&Promise.all(t.eventListener.map(function(n){if(o.isFunction(n))return n(e,r);var i="eventListener "+o.toString(n)+" is not Function";return s.warnError(i,t._develop),Promise.reject(i)}))},e}();r.default=u},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){return function(e){var r=e.develop,t=void 0!==r&&r;this._develop=t}}();r.default=n},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.reportType=["unKownType","log","network","vue"],r.version="2.0.0-beta.1"},function(e,r,t){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r};Object.defineProperty(r,"__esModule",{value:!0});var i=n(t(0)),o=function(){if(!window.localStorage)return!1;var e=i.getStorage("deviceId");return e||(e=i.getUniqueID(),i.setStorage("deviceId",e)),e};r.default=function(){return o()}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,r,t){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r};Object.defineProperty(r,"__esModule",{value:!0});var i=n(t(0)),o=n(t(1));r.preventStackError=function(e){var r=e.msg,t=e.pipeIndex;if(!r||!i.isExist(t)||!i.isExist(r.data))return!0;if(!this.pipeUser[t])return this._config.develop&&o.warnError("send pipe Message Maybe happend Endless loop , will ignore in the message"),!0;try{var n=JSON.stringify(r.data)}catch(e){return o.warnError("find error : "+e),!0}return this.stackCountBuff[n]?this.stackCountBuff[n]++:this.stackCountBuff[n]=1,this.resetStackCount(),this.judgeAnomaly(this.stackCountBuff[n],e)},r.judgeAnomaly=function(e,r){r.msg;var t=r.pipeIndex;return e>10&&e<20?(o.warnError("send  pipe Message during 1000ms in Over 20 times. maybe Anomaly "),!1):e>20&&(this.pipeUser[t]=null,o.warnError("send pipe Message during 1000ms in Over 20 times,maybe happend Endless loop"),!0)},r.resetStackCount=function(){var e=this;e.stackTimeFlag||(e.stackTimeFlag=!0,setTimeout(function(){e.stackCountBuff={},e.stackTimeFlag=!1},1e3))}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=!1;r.isLock=function(){return this.receiveLock},r.openLock=function(){var e=this;if(e.receiveLock&&e._config.queueLock)return!1;e.receiveLock=!0,e._config.timeOutUnlock&&setTimeout(function(){e.closeLock()},e._config.receiveUnlockTime)},r.closeLock=function(){if(!this.receiveLock)return!1;n&&(window.cleanTimeout(n),n=!1),this.receiveLock=!1}},function(e,r,t){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r};Object.defineProperty(r,"__esModule",{value:!0});var i=n(t(0)),o=n(t(1));r.sendPipeMessage=function(e,t,n){var o=this,s={pipeIndex:e,msg:t,options:n};return!o.isLock()&&!o.preventStackError(s)&&(o.messageQueue.push(s),!o.waiting&&void setTimeout(function(){var e=i.extend([],o.messageQueue);o.messageQueue=[],r.noticeListener.call(o,e)}))},r.noticeListener=function(e){var r=this;if(!i.isArray(e)||0===e.length)return!1;r.waiting=!0;for(var t=0;t<e.length;t++){var n=e[t],s=n.pipeIndex,a=n.msg,u=n.options;r.pipeUser.map(function(e,t){if(!e||!e.receiveCallback||!i.isFunction(e.receiveCallback))return!1;if(s===t)return!1;var n=e.receiveCallback;try{r.openLock();var c=n(a,u);c&&i.isObject(c)&&(c instanceof Promise||c.then&&i.isFunction(c.then))?c.then(r.closeLock,r.closeLock):r.closeLock()}catch(e){r.closeLock(),o.warnError("use pipe message notice is runing error:"+e)}})}r.waiting=!1}},function(e,r,t){"use strict";var n=this&&this.__read||function(e,r){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var n,i,o=t.call(e),s=[];try{for(;(void 0===r||r-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(t=o.return)&&t.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spread||function(){for(var e=[],r=0;r<arguments.length;r++)e=e.concat(n(arguments[r]));return e},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r};Object.defineProperty(r,"__esModule",{value:!0});var s=o(t(0)),a=o(t(1));r.registerRecivePipeMessage=function(e){var r=this;return r.pipeUser[e].receiveCallback?(a.warnError("register recive pipe index is Occupy"),!1):function(t,n){if(!t||!s.isFunction(t))return a.warnError("registerRecivePipeMessage method receive function is not right"),!1;r.pipeUser[e].receiveCallback=function(){var e=s.toArray(arguments);return n?t.apply(n,e):t.apply(void 0,i(e))}}}},function(e,r,t){"use strict";var n=this&&this.__read||function(e,r){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var n,i,o=t.call(e),s=[];try{for(;(void 0===r||r-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(t=o.return)&&t.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spread||function(){for(var e=[],r=0;r<arguments.length;r++)e=e.concat(n(arguments[r]));return e},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r};Object.defineProperty(r,"__esModule",{value:!0});var s=o(t(0)),a=o(t(1));r.use=function(e){if(!e||!s.isFunction(e)&&!s.isClassObject(e))return a.warnError("use method receive provider is not right"),!1;var r=this._config,t=s.isFunction(e)?new e(r):e,n=t.apply,i=void 0===n?null:n;if(!i||!s.isFunction(i))return a.warnError("use method receive provider is not apply method"),!1;this.injection(t,i)},r.injection=function(e,r){var t=this,n=this._config;if(!r||!s.isFunction(r))return a.warnError("injection receive ApplyFn is undefined or no function"),!1;var i=t.registerPipeListenerUser();try{var o=r.call(e,i,n);if(s.isObject&&!s.isEmptyObject(o))return void t.oldVsersion_Danger_MixinKoInstance(e,o);t.$keepObserver.registerApi&&s.isArray(o)&&!s.isEmptyArray(o)&&o.forEach(function(e){if(s.isObject(e)&&!s.isEmptyObject(e)){var r=e.apiName,n=void 0===r?"":r,i=e.callback,o=void 0===i?void 0:i;if(!n||!o)return a.warnError("apiName is '' or callback is undefined");t.registerApi(n,o)}})}catch(e){a.warnError("injection receive ApplyFn is runing find error:"+e)}},r.registerPipeListenerUser=function(){var e=this,r=e.pipeUser.length,t={pipeIndex:r,receiveCallback:null,sendPipeMessage:function(){return e.sendPipeMessage.apply(e,i([r],arguments))},registerRecivePipeMessage:null};return e.pipeUser[r]=t,t.registerRecivePipeMessage=e.registerRecivePipeMessage(r),{registerRecivePipeMessage:function(){return!!e.pipeUser[r]&&t.registerRecivePipeMessage.apply(t,i(arguments))},sendPipeMessage:function(){return!!e.pipeUser[r]&&t.sendPipeMessage.apply(t,i(arguments))}}}},function(e,r,t){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r};Object.defineProperty(r,"__esModule",{value:!0});var i=n(t(0)),o=n(t(1));r.oldVsersion_Danger_MixinKoInstance=function(e,r){if(!r||i.isEmptyObject(r))return o.warnError("injection ApplyFn return Object is undefined"),!1;var t=this.$keepObserver;for(var n in r){var s=r[n];s&&i.isFunction(s)||o.warnError("injection ApplyFn return Object attr"+n+"is not right"),t[n]?o.warnError("injection Discover namesake methods"):Object.defineProperty(t,n,{configurable:!1,enumerable:!0,value:function(r){return function(){var t=i.toArray(arguments);try{return r.apply(e,t)}catch(e){o.warnError("injection  methods "+n+" runing find error"+e)}}}(s)})}}},function(e,r,t){"use strict";var n=this&&this.__extends||function(){var e=function(r,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(r,t)};return function(r,t){function n(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var o=i(t(2)),s=t(46),a=t(45),u=t(44),c=t(43),f=t(42),l=t(41),p=function(e){function r(r,t){var n=e.call(this,t)||this;return n.injection=a.injection.bind(n),n.registerPipeListenerUser=a.registerPipeListenerUser.bind(n),n.registerRecivePipeMessage=u.registerRecivePipeMessage.bind(n),n.oldVsersion_Danger_MixinKoInstance=s.oldVsersion_Danger_MixinKoInstance.bind(n),n.sendPipeMessage=c.sendPipeMessage.bind(n),n.noticeListener=c.noticeListener.bind(n),n.isLock=f.isLock.bind(n),n.openLock=f.openLock.bind(n),n.closeLock=f.closeLock.bind(n),n.preventStackError=l.preventStackError.bind(n),n.judgeAnomaly=l.judgeAnomaly.bind(n),n.resetStackCount=l.resetStackCount.bind(n),n.use=a.use.bind(n),n._config=t,n.$keepObserver=r,n.waiting=!1,n.receiveLock=!1,n.stackCountBuff={},n.stackTimeFlag=!1,n.messageQueue=[],n.pipeUser=[],n}return n(r,e),r}(o.default);r.default=p},function(e,r,t){"use strict";var n=this&&this.__read||function(e,r){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var n,i,o=t.call(e),s=[];try{for(;(void 0===r||r-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(t=o.return)&&t.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spread||function(){for(var e=[],r=0;r<arguments.length;r++)e=e.concat(n(arguments[r]));return e},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r};Object.defineProperty(r,"__esModule",{value:!0});var s=o(t(1));r.registerApi=function(e,r){if(this.apis[e])return s.warnError("apiName:"+e+" is defined");this.apis[e]=r},r.apis=function(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return this.apis[e]?this.apis[e].apply(void 0,i(r)):s.warnError("apiName:"+e+" is undefined")}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.init=function(){this._config.projectVersion&&this._config.updateVersionClearCache&&this.updateVersionClearCache()}},function(e,r,t){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r};Object.defineProperty(r,"__esModule",{value:!0});var i=n(t(0)),o=/^keepObserverData/i;r.updateVersionClearCache=function(){var e=i.getStorage("versionRecord");if(!this._config.projectVersion||this._config.projectVersion===e)return!1;if(!window.localStorage)return!1;for(var r in window.localStorage)o.test(r)&&(localStorage.removeItem(r),this.$devWarn("[keepObserver] updateVersionRecord key:"+r));i.setStorage("versionRecord",this._config.projectVersion)}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default={queueLock:!0,timeOutUnlock:!0,forceUnlockTime:1e3,updateVersionClearCache:!1}},function(e,r,t){"use strict";var n=this&&this.__extends||function(){var e=function(r,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(r,t)};return function(r,t){function n(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var s=i(t(0)),a=o(t(5)),u=o(t(51)),c=o(t(2)),f=t(4),l=t(50),p=t(49),d=t(48),v=o(t(47)),g=function(e){function r(r){var t=e.call(this,r)||this;return t.init=p.init.bind(t),t.updateVersionClearCache=l.updateVersionClearCache.bind(t),t.registerApi=d.registerApi.bind(t),t.apis=d.apis.bind(t),t._config=s.extend(u.default,r,{version:f.version,deviceID:a.default()}),t._pipe=new v.default(t,t._config),t.init(),t}return n(r,e),r.prototype.use=function(e){return this._pipe.use(e)},r}(c.default);e.exports=g,e.exports.default=e.exports}])});